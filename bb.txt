
<%
' 필히 => 로거 신규/추가 시 공통 주석 양식 사용 --------------------------------
'###############################################################################
' 업체 : 요청 업체 
' 용도 : 사용 용도 
' 작업 이력 
'     날짜 - [부서]담당자 - [부서]개발자 - 작업내용
'     날짜 - [부서]담당자 - [부서]개발자 - 작업내용
'     날짜 - [부서]담당자 - [부서]개발자 - 작업내용
'###############################################################################
%>

<%
'###############################################################################
' 업체 : Insight Logger Report
' 용도 : (기본) 사이트 분석용
' 작업 이력 
'     2009-05-21 - [서비스기획팀]김문수 - [웹개발팀]전형표 - 하단공통
'     2009-06-03 - [서비스기획팀]김문수 - [웹개발팀]전형표 - 라인맵 처리 스크립트 추가
'     2015-02-11 - [] - [웹개발팀]고 건 - 메일을 통해 들어오는 로거 처리
'###############################################################################
%>
<%
    'Logger Report 절대 지우지말것-------------------- 2009.05.21
    '라인맵 처리 스크립트 추가.(전형표 2009.06.03)

    uid=trim(fncRequestCookie("userid"))
    CK_LOG_TRK=trim(fncRequestCookie("CK_LOG_TRK"))
    CK_USER_INFO=trim(fncRequestCookie("CK_USER_INFO"))

	ARR_LOG_TRK = split(CK_LOG_TRK,"|")
	If ubound(ARR_LOG_TRK) > 0 Then
		LOG_TRK_SX =  ARR_LOG_TRK(0)		' 로거 성별
		LOG_TRK_AG =  ARR_LOG_TRK(1)		' 로거 학년
		LOG_TRK_EC1 =  ARR_LOG_TRK(2)		'
		LOG_TRK_EC2 =  ARR_LOG_TRK(3)		'
	End If
    loger = fncRequest("loger")    '메일을 통해 들어오는 로거 처리 (2015-02-11 고건)
%>

<script type="text/javascript">
    <% if loger <> "" then %>
         try{logerClickTrace('EVT','<%=loger%>')}catch(e){}
    <% end if %>

    function logerClickTrace(pCode, pContent) {}
	function _trk_clickTrace( pCode, pContent ){}


    function html_escape(str){

     return str.replace(/&/g, "").replace(/</g,"")
         .replace(/>/g,"").replace(/"/g,"")
         .replace(/'/g,"").replace(/\//g,"_");

    }

    var navi = document.getElementsByName("NaviText");
    var strNaviText = "";
    if (navi.length > 1){
        for(var i = 0 ; i<navi.length; i++){
            var str = "/";
            strNaviText += str+html_escape(navi[i].innerHTML);
        }
    }

    _TRK_RK = "<%=ucase(uid)%>";
    _TRK_ID = "<%=ucase(uid)%>";
	_TRK_EC1 = "<%=Ucase(LOG_TRK_EC1)%>"
	_TRK_EC2 = "<%=Ucase(LOG_TRK_EC2)%>"


    try{
        if(!_TRK_CP) {_TRK_CP = strNaviText.toUpperCase().replace(/\/HOME/g,""); }
        else{_TRK_CP = _TRK_CP.toUpperCase().replace(/\/HOME/g,"");}
    }catch(e){
        _TRK_CP = strNaviText.toUpperCase().replace(/\/HOME/g,"");
    }

</script>



<% '------------------------------------------------- %>

<%
	'개발서버일 경우
	If lcase(fncRequestVariables("HTTP_HOST"))="next.megastudy.net" Then '넥스트
		logger_view = "Y"
	end if

	select case uid

        case "coreadesign","eazy","thinkbug","drashi","howntw","luckyyen","spicena","shan21c","mintria": logger_view = "Y"

	end select

	if logger_view = "Y" then
 %>
   <%=Request.ServerVariables("PATH_TRANSLATED")%>
    <div id="naviTest"></div>
    <script language="javascript">
    	var printStr = "";

		try{
		if (_TRK_CP) printStr += "<br>_TRK_CP-->"+_TRK_CP;
		}catch(e){
			printStr += "<br>_TRK_CP-->";
		}

		try{
		if (_TRK_SX) printStr += "<br>_TRK_SX-->"+_TRK_SX;
		}catch(e){
			printStr += "<br>_TRK_SX-->";
		}

		try{
		if (_TRK_AG) printStr += "<br>_TRK_AG-->"+_TRK_AG;
		}catch(e){
			printStr += "<br>_TRK_AG-->";
		}

		try{
		if (_TRK_EC1) printStr += "<br>_TRK_EC1-->"+_TRK_EC1;
		}catch(e){
			printStr += "<br>_TRK_EC1-->";
		}

		try{
		if (_TRK_EC2) printStr += "<br>_TRK_EC2-->"+_TRK_EC2;
		}catch(e){
			printStr += "<br>_TRK_EC2-->";
		}

		try{
		if (_TRK_IK) printStr += "<br>_TRK_IK-->"+_TRK_IK;
		}catch(e){
			printStr += "<br>_TRK_IK-->";
		}


		try{
		if (_TRK_PN) printStr += "<br>_TRK_PN-->"+_TRK_PN;
		}catch(e){
			printStr += "<br>_TRK_PN-->";
		}

		try{
		if ( _TRK_MF) printStr += "<br>_TRK_MF-->"+ _TRK_MF;
		}catch(e){
			printStr += "<br>_TRK_MF-->";
		}

		try{
		if ( _TRK_CC) printStr += "<br>_TRK_CC-->"+ _TRK_CC;
		}catch(e){
			printStr += "<br>_TRK_CC-->";
		}

		try{
		if ( _TRK_PI) printStr += "<br>_TRK_PI-->"+ _TRK_PI;
		}catch(e){
			printStr += "<br>_TRK_PI-->";
		}

		try{
		    if ( _TRK_ID) printStr += "<br>_TRK_ID-->"+ _TRK_ID;
		    }catch(e){
			    printStr += "<br>_TRK_ID-->";
        }


        try {
            if (_TRK_ICMP) printStr += "<br>_TRK_ICMP-->" + _TRK_ICMP;
        } catch (e) {
            printStr += "<br>_TRK_ICMP-->";
        }



		try{
			if ( NTPT_PGEXTRA) printStr += "<br>NTPT_PGEXTRA-->"+ NTPT_PGEXTRA;
		}catch(e){

		}

		try{
			document.getElementById("naviTest").innerHTML = printStr;
		}catch(e){}
    </script>

<% end if  %>


<%
'###############################################################################
' 업체 : (4) 페이스북 (Facebook Pixel Code)
' 용도 : 페이스북 광고 성과 분석용
' 작업 이력 
'     2017-11-06 - [마케팅3팀]박미현 - [웹개발팀]이광호 - 하단공통 추가
'     2019-01-16 - [마케팅3팀]이수지 - [웹개발팀]권화중 - 담당자 변경
'###############################################################################
%>
<!-- Facebook Pixel Code -->
<%
    logViewTxt = ""
    logPath = lcase(fncRequestVariables("PATH_INFO"))

    select case logPath
        case "/member/member_2011/done_join.asp" : logViewTxt = "member"
    end select

    if logViewTxt <> "" Then
%>
<script>
  fbq('track', 'join');
</script>
<%
    End if    
%>
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1513677162048872');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1513677162048872&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->


<%
'###############################################################################
' 업체 : 구글 애널리틱스(GA) 
' 용도 : (기본)
' 작업 이력 
'     2017-04-20 - [] - [웹개발팀]김영무 - 하단공통
'###############################################################################
%>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-97693194-1', 'auto');
    ga('send', 'pageview');
    ga('require', 'ecommerce', 'ecommerce.js');
</script>


<%
'###############################################################################
' 업체 : (5) 모비온 (Mobon Tracker)
' 용도 : 광고 운영 매체용
' 작업 이력 
'     2018-03-16 - [마케팅3팀]이수지 - [웹개발팀]권화중 - 하단공통
'###############################################################################
%>
<!-- Mobon Tracker v3.1 [공용] start -->
<script type="text/javascript">
<!--
    function mobRf() {
        var rf = new EN();
        rf.setSSL(true);
        rf.sendRf();
    }
  //-->
</script>
<script src="https://cdn.megadata.co.kr/js/enliple_min2.js" defer="defer" onload="mobRf()"></script>
<!-- Mobon Tracker v3.1 [공용] end -->

<%
'###############################################################################
' 업체 : (6) 에이스트레이더 (ACEtrader)
' 용도 : 광고 운영 매체용
' 작업 이력 
'     2019-05-17 - [마케팅3팀]박미현 - [웹개발팀]권화중 - 하단공통
'###############################################################################
%>
<% ' ACEtrader_공통스크립트(PC  %>
<script type="text/javascript" src="https://static.tagmanager.toast.com/tag/view/490"></script>
<script type="text/javascript">
    window.ne_tgm_q = window.ne_tgm_q || [];
    window.ne_tgm_q.push(
 {
     tagType: 'visit',
     device: 'web'/*web, mobile, tablet*/,
     uniqValue: '',
     pageEncoding: 'euc-kr'
 });
 </script>


<%
'###############################################################################
' 업체 : (7) 카카오 (daum)
' 용도 : 카카오 광고 성과 분석용
' 작업 이력 
'     2018-07-03 - [마케팅]이효민 - [웹개발팀]권화중 - 하단공통
'###############################################################################
%>
<% '카카오(이효민,2018-07-03   %>
<script type="text/javascript" charset="UTF-8" src="https://t1.daumcdn.net/adfit/static/kp.js"></script>
<script type="text/javascript">
    kakaoPixel('4465481856848738690').pageView('pc');
</script>

<%
'###############################################################################
' 업체 : (8) 트위터 (Twitter) 
' 용도 : 광고 운영 매체용
' 작업 이력 
'     2020-02-11 - [마케팅3팀]이수지 - [웹개발팀]최진혁 - 하단공통
'###############################################################################
%>
<%'=======나스미디어====== ADD 20200211 %>
<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='https://static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','o33ff');
twq('track','PageView');
</script>
<!-- End Twitter universal website tag code -->

<!-- Twitter universal website tag code -->
<%'=======메조미디어====== ADD 20201029%>
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='https://static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','o3054');
twq('track','PageView');
</script>
<!-- End Twitter universal website tag code -->


<%
'###############################################################################
' 업체 : (9) 네이버애널리틱스
' 용도 : 사이트 분석용
' 작업 이력 
'     2020-02-27 - [마케팅3팀]박미현 - [웹개발팀]최진혁 - 하단공통
'###############################################################################
%>
<script type="text/javascript" src="https://wcs.naver.net/wcslog.js"></script>
<script type="text/javascript">
if(!wcs_add) var wcs_add = {};
wcs_add["wa"] = "2f77e1b1b9114e";
wcs_do();
</script>

<%
'###############################################################################
' 업체 : (11) 구글 태그 매니저(Google Tag Manager)
' 용도 : 집계용 스크립트
' 작업 이력 
'     2020-11-04 - [마케팅전략실]조경진 - [웹개발팀]최진혁 - 하단공통
'###############################################################################
%>
<%
	now_url_path = lcase(fncRequestVariables("PATH_INFO"))
	If InStr(now_url_path, "/teacher_v2/") > 0 Then 
%>
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TX72TGD"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
<%	end if %>
